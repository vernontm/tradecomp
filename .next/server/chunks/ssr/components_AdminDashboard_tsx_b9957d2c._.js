module.exports=[20533,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(78560),e=a.i(70106);let f=(0,e.default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var g=a.i(24669);let h=(0,e.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),i=(0,e.default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),j=(0,e.default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var k=a.i(92e3),l=a.i(16201);function m({whopUser:a,companyId:e,companyName:m}){let[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null);(0,c.useEffect)(()=>{v()},[]);let v=async()=>{try{let{data:a,error:b}=await d.supabase.from("users").select("*").order("created_at",{ascending:!1});if(b)throw b;let{data:c,error:e}=await d.supabase.from("trading_accounts").select("*");if(e)throw e;let f=a.map(a=>({...a,accounts:c.filter(b=>b.user_id===a.id)}));o(f)}catch(a){console.error("Error fetching users:",a)}finally{q(!1)}},w=async()=>{s(!0),u(null);try{let a=await fetch("/api/refresh-balances",{method:"POST",headers:{"x-admin-api-key":"admin-api-key-placeholder"}}),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to refresh balances");u({type:"success",text:`Successfully refreshed ${b.updated} accounts`}),v()}catch(a){u({type:"error",text:a.message||"Failed to refresh balances"})}finally{s(!1)}},x=async(a,b)=>{try{let{error:c}=await d.supabase.from("users").update({is_admin:!b}).eq("id",a);if(c)throw c;o(c=>c.map(c=>c.id===a?{...c,is_admin:!b}:c)),u({type:"success",text:"User admin status updated"})}catch(a){u({type:"error",text:"Failed to update user status"})}},y=async(a,b)=>{try{let{error:c}=await d.supabase.from("trading_accounts").update({show_on_leaderboard:!b}).eq("id",a);if(c)throw c;o(c=>c.map(c=>({...c,accounts:c.accounts.map(c=>c.id===a?{...c,show_on_leaderboard:!b}:c)}))),u({type:"success",text:"Account leaderboard status updated"})}catch(a){u({type:"error",text:"Failed to update account status"})}};if(p)return(0,b.jsx)("div",{className:"min-h-screen bg-dark flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent"}),(0,b.jsx)("p",{className:"mt-4 text-gray-400",children:"Loading admin dashboard..."})]})});let z=n.reduce((a,b)=>a+b.accounts.length,0),A=n.reduce((a,b)=>a+b.accounts.filter(a=>a.is_active).length,0);return(0,b.jsx)("div",{className:"min-h-screen bg-dark p-8",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,b.jsx)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)(i,{className:"text-primary",size:32}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-gradient-primary",children:"Admin Dashboard"})]}),(0,b.jsxs)("p",{className:"text-white/70",children:["Managing: ",m," â€¢ Welcome, ",a.name]})]}),(0,b.jsxs)("button",{onClick:w,disabled:r,className:"flex items-center gap-2 px-4 py-2 gradient-primary text-white rounded-lg hover:opacity-90 transition-all disabled:opacity-50",children:[(0,b.jsx)(h,{size:18,className:r?"animate-spin":""}),r?"Refreshing...":"Refresh All Balances"]})]})}),t&&(0,b.jsxs)("div",{className:`p-4 rounded-xl border flex items-center gap-3 ${"success"===t.type?"bg-green-500/10 border-green-500 text-green-500":"bg-red-500/10 border-red-500 text-red-500"}`,children:["success"===t.type?(0,b.jsx)(l.CheckCircle,{size:20}):(0,b.jsx)(k.AlertCircle,{size:20}),(0,b.jsx)("span",{children:t.text})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("p",{className:"text-sm text-white/50 uppercase tracking-wider",children:"Total Users"}),(0,b.jsx)(f,{size:20,className:"text-primary"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:n.length})]}),(0,b.jsxs)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("p",{className:"text-sm text-white/50 uppercase tracking-wider",children:"Total Accounts"}),(0,b.jsx)(j,{size:20,className:"text-primary"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:z})]}),(0,b.jsxs)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("p",{className:"text-sm text-white/50 uppercase tracking-wider",children:"Active Accounts"}),(0,b.jsx)(g.TrendingUp,{size:20,className:"text-primary"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:A})]})]}),(0,b.jsxs)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl overflow-hidden",children:[(0,b.jsx)("div",{className:"p-6 border-b border-white/10",children:(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Users & Accounts"})}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-white/5 border-b border-white/10",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white/70 uppercase tracking-wider",children:"User"}),(0,b.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white/70 uppercase tracking-wider",children:"Accounts"}),(0,b.jsx)("th",{className:"px-6 py-4 text-right text-sm font-semibold text-white/70 uppercase tracking-wider",children:"Total Balance"}),(0,b.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-white/70 uppercase tracking-wider",children:"Admin"}),(0,b.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-white/70 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-white/10",children:n.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-white/5",children:[(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.username}),(0,b.jsx)("p",{className:"text-sm text-white/50",children:a.email})]})}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsxs)("span",{className:"text-white/70",children:[a.accounts.length," account(s)"]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-right",children:(0,b.jsxs)("span",{className:"font-medium",children:["$",a.accounts.reduce((a,b)=>a+b.current_balance,0).toFixed(2)]})}),(0,b.jsx)("td",{className:"px-6 py-4 text-center",children:(0,b.jsx)("button",{onClick:()=>x(a.id,a.is_admin),className:`px-3 py-1 rounded-full text-xs font-medium ${a.is_admin?"bg-primary/20 text-primary":"bg-white/10 text-white/50"}`,children:a.is_admin?"Admin":"User"})}),(0,b.jsx)("td",{className:"px-6 py-4 text-center",children:a.accounts.map(a=>(0,b.jsxs)("button",{onClick:()=>y(a.id,a.show_on_leaderboard),className:`text-xs px-2 py-1 rounded mr-1 ${a.show_on_leaderboard?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,title:`${a.account_number}: ${a.show_on_leaderboard?"On Leaderboard":"Hidden"}`,children:["#",a.account_number.slice(-4)]},a.id))})]},a.id))})]})})]})]})})}a.s(["default",()=>m],20533)}];

//# sourceMappingURL=components_AdminDashboard_tsx_b9957d2c._.js.map
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33690,e=>{"use strict";e.i(47167);var s=e.i(43476),t=e.i(71645),a=e.i(17927),r=e.i(75254);let i=(0,r.default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var d=e.i(25652);let c=(0,r.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),l=(0,r.default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),n=(0,r.default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var o=e.i(63209),x=e.i(69638);function h({whopUser:e,companyId:r,companyName:h}){let[m,p]=(0,t.useState)([]),[u,b]=(0,t.useState)(!0),[y,f]=(0,t.useState)(!1),[j,g]=(0,t.useState)(null);(0,t.useEffect)(()=>{w()},[]);let w=async()=>{try{let{data:e,error:s}=await a.supabase.from("users").select("*").order("created_at",{ascending:!1});if(s)throw s;let{data:t,error:r}=await a.supabase.from("trading_accounts").select("*");if(r)throw r;let i=e.map(e=>({...e,accounts:t.filter(s=>s.user_id===e.id)}));p(i)}catch(e){console.error("Error fetching users:",e)}finally{b(!1)}},N=async()=>{f(!0),g(null);try{let e=await fetch("/api/refresh-balances",{method:"POST",headers:{"x-admin-api-key":"admin-api-key-placeholder"}}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to refresh balances");g({type:"success",text:`Successfully refreshed ${s.updated} accounts`}),w()}catch(e){g({type:"error",text:e.message||"Failed to refresh balances"})}finally{f(!1)}},v=async(e,s)=>{try{let{error:t}=await a.supabase.from("users").update({is_admin:!s}).eq("id",e);if(t)throw t;p(t=>t.map(t=>t.id===e?{...t,is_admin:!s}:t)),g({type:"success",text:"User admin status updated"})}catch(e){g({type:"error",text:"Failed to update user status"})}},k=async(e,s)=>{try{let{error:t}=await a.supabase.from("trading_accounts").update({show_on_leaderboard:!s}).eq("id",e);if(t)throw t;p(t=>t.map(t=>({...t,accounts:t.accounts.map(t=>t.id===e?{...t,show_on_leaderboard:!s}:t)}))),g({type:"success",text:"Account leaderboard status updated"})}catch(e){g({type:"error",text:"Failed to update account status"})}};if(u)return(0,s.jsx)("div",{className:"min-h-screen bg-dark flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent"}),(0,s.jsx)("p",{className:"mt-4 text-gray-400",children:"Loading admin dashboard..."})]})});let _=m.reduce((e,s)=>e+s.accounts.length,0),A=m.reduce((e,s)=>e+s.accounts.filter(e=>e.is_active).length,0);return(0,s.jsx)("div",{className:"min-h-screen bg-dark p-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,s.jsx)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)(l,{className:"text-primary",size:32}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gradient-primary",children:"Admin Dashboard"})]}),(0,s.jsxs)("p",{className:"text-white/70",children:["Managing: ",h," â€¢ Welcome, ",e.name]})]}),(0,s.jsxs)("button",{onClick:N,disabled:y,className:"flex items-center gap-2 px-4 py-2 gradient-primary text-white rounded-lg hover:opacity-90 transition-all disabled:opacity-50",children:[(0,s.jsx)(c,{size:18,className:y?"animate-spin":""}),y?"Refreshing...":"Refresh All Balances"]})]})}),j&&(0,s.jsxs)("div",{className:`p-4 rounded-xl border flex items-center gap-3 ${"success"===j.type?"bg-green-500/10 border-green-500 text-green-500":"bg-red-500/10 border-red-500 text-red-500"}`,children:["success"===j.type?(0,s.jsx)(x.CheckCircle,{size:20}):(0,s.jsx)(o.AlertCircle,{size:20}),(0,s.jsx)("span",{children:j.text})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("p",{className:"text-sm text-white/50 uppercase tracking-wider",children:"Total Users"}),(0,s.jsx)(i,{size:20,className:"text-primary"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:m.length})]}),(0,s.jsxs)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("p",{className:"text-sm text-white/50 uppercase tracking-wider",children:"Total Accounts"}),(0,s.jsx)(n,{size:20,className:"text-primary"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:_})]}),(0,s.jsxs)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("p",{className:"text-sm text-white/50 uppercase tracking-wider",children:"Active Accounts"}),(0,s.jsx)(d.TrendingUp,{size:20,className:"text-primary"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:A})]})]}),(0,s.jsxs)("div",{className:"bg-sidebar/80 backdrop-blur-xl border border-white/10 rounded-2xl overflow-hidden",children:[(0,s.jsx)("div",{className:"p-6 border-b border-white/10",children:(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Users & Accounts"})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-white/5 border-b border-white/10",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white/70 uppercase tracking-wider",children:"User"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white/70 uppercase tracking-wider",children:"Accounts"}),(0,s.jsx)("th",{className:"px-6 py-4 text-right text-sm font-semibold text-white/70 uppercase tracking-wider",children:"Total Balance"}),(0,s.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-white/70 uppercase tracking-wider",children:"Admin"}),(0,s.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-white/70 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-white/10",children:m.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-white/5",children:[(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.username}),(0,s.jsx)("p",{className:"text-sm text-white/50",children:e.email})]})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsxs)("span",{className:"text-white/70",children:[e.accounts.length," account(s)"]})}),(0,s.jsx)("td",{className:"px-6 py-4 text-right",children:(0,s.jsxs)("span",{className:"font-medium",children:["$",e.accounts.reduce((e,s)=>e+s.current_balance,0).toFixed(2)]})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:(0,s.jsx)("button",{onClick:()=>v(e.id,e.is_admin),className:`px-3 py-1 rounded-full text-xs font-medium ${e.is_admin?"bg-primary/20 text-primary":"bg-white/10 text-white/50"}`,children:e.is_admin?"Admin":"User"})}),(0,s.jsx)("td",{className:"px-6 py-4 text-center",children:e.accounts.map(e=>(0,s.jsxs)("button",{onClick:()=>k(e.id,e.show_on_leaderboard),className:`text-xs px-2 py-1 rounded mr-1 ${e.show_on_leaderboard?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,title:`${e.account_number}: ${e.show_on_leaderboard?"On Leaderboard":"Hidden"}`,children:["#",e.account_number.slice(-4)]},e.id))})]},e.id))})]})})]})]})})}e.s(["default",()=>h],33690)}]);